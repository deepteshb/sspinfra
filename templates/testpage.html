{% extends "base.html" %}
{% block content %}
<div class="container">
  <div class="row">
    <div class="col login-sec">
      <h2 class="">Launch Product</h2>
      <p class="card p-3" style="background-color: rgb(243, 243, 243);">Select your customer and you will be able
        to see the associated Products and Components for the customer. Then you can add additional details to
        create your launch configuration.
        Once you have decided on the launch configuration submit your request. Your request will be queued and
        once the infrastructure is provisioned you will recieve an email with details.
      </p>
      <a class="btn btn-sg" href="{{url_for('userservicelist')}}"><i class="fa fa-step-backward"
          aria-hidden="true"></i>&nbsp;Go Back</a>
    </div>
  </div>
  <div class=" container">
    <table class="table">
      <tbody>
        <th>Customer</th>
        <th>Product</th>
        <th>Version</th>
        <th>Component</th>
        <th>Instance</th>
        <th>Actions</th>
      </tbody>
    </table>
    <form class="form-row" action="" method="POST">
      {{form.csrf_token}}
      {{form.customer}}
      {{form.product}}
      {{form.version}}
      {{form.component}}
      {{form.instance}}
      <input type="button" class="btn btn-primary" value="+">
      <input type="button" class="btn btn-primary" value="-">
    </form>
  </div>
</div>
<script>
  let selected_customer = document.getElementById('customer');
  let selected_product = document.getElementById('product');
  let selected_version = document.getElementById('version');
  let selected_component = document.getElementById('component');

  selected_customer.onchange = function () {
    customer = selected_customer.value;
    fetch('/testpage/' + customer).then(function(response) {
      response.json().then(function(data){
        let optionHTML = '';
        for (product of data.products){
          optionHTML += '<option value="'+ product.id + '">' + product.product + '</option>';
        }
        selected_product.innerHTML = optionHTML;

      });
      
    });

    }

  selected_product.onchange = function () {
    product = selected_product.value;
    fetch('/versions/' + product).then(function(response) {
      response.json().then(function(data){
        let optionHTML = '';
        for (version of data.versions){
          optionHTML += '<option value="'+ version.id + '">' + version.version + '</option>';
        }
        selected_version.innerHTML = optionHTML;

      });
      
    });

  }

  selected_version.onchange = function () {
    version = selected_version.value;
    fetch('/testpage/' + customer).then(function(response) {
      response.json().then(function(data){
        let optionHTML = '';
        for (product of data.products){
          optionHTML += '<option value="'+ product.id + '">' + product.product + '</option>';
        }
        selected_product.innerHTML = optionHTML;

      });
      
    });

  }

  selected_component.onchange = function () {
    component = selected_component.value;
    fetch('/testpage/' + customer).then(function(response) {
      response.json().then(function(data){
        let optionHTML = '';
        for (product of data.products){
          optionHTML += '<option value="'+ product.id + '">' + product.product + '</option>';
        }
        selected_product.innerHTML = optionHTML;

      });
      
    });

  }

</script>
{% endblock %}